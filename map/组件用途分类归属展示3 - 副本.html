<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    html,
    body {
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>
</head>

<body>
  <div style="display: flex;height:100%">
    <div id="chart" class="chart" style="width:45%;height:90%"></div>
    <div id="chart2" class="chart2" style="width:65%;height:100%"></div>
  </div>
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js"></script>
  <script src="./echarts-full.min.js"></script>
  <script>
    const targetCoord = [0, 40]
    const targetCoord1 = [10, 40]
    const curveness = 0.2
    const linesData = []
    const color1 = 'rgba(99,117,148,0.8)'
    const color2 = 'rgba(94,178,237,0.8)'
    const color3 = 'rgba(44,211,174,0.8)'
    const color4 = 'rgba(248,112,135,0.8)'
    const color5 = 'rgba(162,120,192,0.8)'

    const categories = [{
      name: '',
      label: {
        show: false,
        normal: {
          fontSize: '14',
          show: false,
        }
      },
    }, {
      name: '',
      label: {
        show: false,
        normal: {
          fontSize: '14'
        }
      },
    }]

    const list = [
      {
        name: "web邮件",
        value: targetCoord,
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "维基百科",
        value: targetCoord1,
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "javaScript图形插件",
        value: [20, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "数据库管理",
        value: [30, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "评论系统",
        value: [40, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "文件工具",
        value: [50, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "CDN",
        value: [60, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "文件管理系统",
        value: [70, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "问题跟踪",
        value: [80, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "内容管理系统",
        value: [90, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "学习管理系统",
        value: [100, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "字体脚本",
        value: [110, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "操作系统",
        value: [120, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "开发工具",
        value: [130, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "远程访问",
        value: [140, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "媒体服务器",
        value: [150, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "网络设备",
        value: [160, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "Web服务器扩展",
        value: [170, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "数据库",
        value: [180, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      },
      {
        name: "自动化营销",
        value: [190, 40],
        symbolSize: 10,
        label: {
          normal: {
            fontSize: '14'
          }
        },
      }
    ]

    console.log(list, '--')


    const items = [{
      name: "硬件层",
      category: 0,
      active: true,
      value: [40, 260],
      itemStyle: {
        normal: {
          color: '#637594'
        }
      },
      label: {
        normal: {
          show: true,
          position: 'top',
          color: '#637594',
          rotate: 0,
          // formatter: function (value) {
          //   return value.data.name
          // }
        },
        // rotate: -90,
      },
    }, {
      name: "系统层",
      category: 0,
      active: true,
      value: [70, 260],
      itemStyle: {
        normal: {
          color: '#5eb2ed'
        }
      },
      label: {
        normal: {
          show: true,
          position: 'top',
          rotate: 0,
          color: '#5eb2ed'
          // formatter: function (value) {
          //   return value.data.name
          // }
        },
      }
    }, {
      name: "应用层",
      category: 0,
      active: true,
      value: [100, 260],
      itemStyle: {
        normal: {
          color: '#2cd3ae'
        }
      },
      label: {
        normal: {
          show: true,
          position: 'top',
          rotate: 0,
          color: '#2cd3ae'
          // formatter: function (value) {
          //   return value.data.name
          // }
        },
      }
    }, {
      name: "支撑层",
      category: 1,
      value: [130, 260],
      itemStyle: {
        normal: {
          color: '#f87087'
        }
      },
      label: {
        normal: {
          show: true,
          position: 'top',
          rotate: 0,
          color: '#f87087'
          // formatter: function (value) {
          //   return value.data.name
          // }
        },
      }
    }, {
      name: "服务层",
      category: 1,
      value: [160, 260],
      itemStyle: {
        normal: {
          color: '#a278c0'
        }
      },
      label: {
        normal: {
          show: true,
          position: 'top',
          rotate: 0,
          color: '#a278c0'
        },
      }
    }]

    const data = items.concat(list)

    // items.forEach(function (el) {
    //   if (el.active) {
    //     linesData.push([{
    //       coord: el.value
    //     }, {
    //       coord: targetCoord
    //     }])
    //   }
    // })


    var links = [
      {
        "source": "硬件层",
        "target": "web邮件",
        "lineStyle": {
          "normal": {
            "color": color1,
            "curveness": curveness
          }
        }
      },
      {
        "source": "系统层",
        "target": "文件工具",
        "lineStyle": {
          "normal": {
            "color": color2,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "web邮件",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "支撑层",
        "target": "CDN",
        "lineStyle": {
          "normal": {
            "color": color4,
            "curveness": curveness
          }
        }
      },
      {
        "source": "服务层",
        "target": "问题跟踪",
        "lineStyle": {
          "normal": {
            "color": color5,
            "curveness": curveness
          }
        }
      },
      {
        "source": "硬件层",
        "target": "学习管理系统",
        "lineStyle": {
          "normal": {
            "color": color1,
            "curveness": curveness
          }
        }
      },
      {
        "source": "硬件层",
        "target": "媒体服务器",
        "lineStyle": {
          "normal": {
            "color": color1,
            "curveness": curveness
          }
        }
      },
      {
        "source": "硬件层",
        "target": "网络设备",
        "lineStyle": {
          "normal": {
            "color": color1,
            "curveness": curveness
          }
        }
      },
      {
        "source": "系统层",
        "target": "操作系统",
        "lineStyle": {
          "normal": {
            "color": color2,
            "curveness": curveness
          }
        }
      },
      {
        "source": "系统层",
        "target": "数据库",
        "lineStyle": {
          "normal": {
            "color": color2,
            "curveness": curveness
          }
        }
      },
      {
        "source": "系统层",
        "target": "内容管理系统",
        "lineStyle": {
          "normal": {
            "color": color2,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "维基百科",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "评论系统",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "文件管理系统",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "字体脚本",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "Web服务器扩展",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "开发工具",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "web服务器扩展",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "应用层",
        "target": "自动化营销",
        "lineStyle": {
          "normal": {
            "color": color3,
            "curveness": curveness
          }
        }
      },
      {
        "source": "支撑层",
        "target": "数据库管理",
        "lineStyle": {
          "normal": {
            "color": color4,
            "curveness": curveness
          }
        }
      },
      {
        "source": "支撑层",
        "target": "自动化营销",
        "lineStyle": {
          "normal": {
            "color": color4,
            "curveness": curveness
          }
        }
      },
      {
        "source": "服务层",
        "target": "javaScript图形插件",
        "lineStyle": {
          "normal": {
            "color": color5,
            "curveness": curveness
          }
        }
      },
      {
        "source": "服务层",
        "target": "远程访问",
        "lineStyle": {
          "normal": {
            "color": color5,
            "curveness": curveness
          }
        }
      }
    ]

    option = {
      title: {
        text: '组件用途分类归属展示',
        left: '20',
        top: '30'
      },
      legend: [{
        formatter: function (name) {
          return echarts.format.truncateText(name, 100, '14px Microsoft Yahei', '…');
        },
        tooltip: {
          show: true
        },
        textStyle: {
          color: '#999'
        },
        selectedMode: false,
        right: 0,
        // data: categories.map(function (el) {
        //   return el.name
        // })
      }],
      xAxis: {
        show: false,
        type: 'value'
      },
      yAxis: {
        show: false,
        type: 'value'
      },
      series: [{
        type: 'graph',
        layout: 'none',
        coordinateSystem: 'cartesian2d',
        symbolSize: 60,
        z: 3,
        focusNodeAdjacency: true,
        label: {
          normal: {
            show: true,
            color: '#5e5e5e',
            position: [10, 20],
            rotate: -90,
            // formatter: function (value) {
            //   return value.data.name.split('').join('\n')
            // }
          },
          // rotate: -90,
        },
        itemStyle: {
          normal: {
            shadowColor: 'none',
            color: '#555555'
          },
          emphasis: {

          }
        },
        lineStyle: {
          normal: {
            width: 8,
            shadowColor: 'none'
          },
        },
        edgeSymbolSize: 8,
        data: data,
        links: links,
        categories: categories
      },
      ]
    }
    var myChart = echarts.init(document.getElementById('chart'));
    myChart.setOption(option)
    window.addEventListener("resize", function () {
      setTimeout(() => {
        myChart.resize();
        myChart2.resize();
      }, 1000)
    });

  </script>
  <script>
    var myChart2 = echarts.init(document.getElementById('chart2'));

    // 使用刚指定的配置项和数据显示图表。
    // myChart.setOption(option);
    myChart2.setOption(option = {

      title: {
        text: '组件分层top100',
        left: '60',
        top: '30'
      },

      tooltip: {
        formatter: function (info) {
          var value = info.value;
          var treePathInfo = info.treePathInfo;
          var treePath = [];

          for (var i = 1; i < treePathInfo.length; i++) {
            treePath.push(treePathInfo[i].name);
          }

          return [
            '<div class="tooltip-title">' + formatUtil.encodeHTML(treePath.join('-')) + '</div>',
          ].join('');
        }
      },
      color: ['#637594', '#5eb2ed', '#2cd3ae', '#f87087', '#a278c0'],
      series: [
        {
          breadcrumb: { show: false },
          name: '',
          type: 'treemap',
          visibleMin: 300,
          label: {
            show: true,
            formatter: '{b}'
          },
          nodeClick: false,
          roam: false,
          upperLabel: {
            show: true,
            color: '#fff',
            height: 20
          },
          itemStyle: {
            borderColor: '#fff',
          },
          levels: getLevelOption(),
          data: [{
            name: '硬件层',            // Second tree
            value: 10,
            children: [{
              name: '绘制墙体',       // Son of first tree
              value: 20,
            }, {
              name: '墙体倒角',       // Second leaf of first tree
              value: 6
            }, {
              name: '墙体连接',       // Second leaf of first tree
              value: 6
            }, {
              name: '墙体打断',       // Second leaf of first tree
              value: 6
            }, {
              name: '饰面创建',       // Second leaf of first tree
              value: 6
            }, {
              name: '墙体附着',       // Second leaf of first tree
              value: 6
            }, {
              name: '墙体分离',       // Second leaf of first tree
              value: 6
            }]
          }, {
            name: '系统层',            // Second tree
            value: 7,
            children: [{
              name: '绘制幕墙',       // Son of first tree
              value: 20,
            }, {
              name: '幕墙网格',       // Second leaf of first tree
              value: 6
            }, {
              name: '幕墙竖梃',       // Second leaf of first tree
              value: 6
            }]
          }, {
            name: '服务层',            // Second tree
            value: 8,
            children: [{
              name: 'Apache Tomcat',       // Son of first tree
              value: 20,
            }, {
              name: 'Apache',       // Second leaf of first tree
              value: 6
            }, {
              name: 'rdp',       // Second leaf of first tree
              value: 6
            }, {
              name: 'Microsoft Windows netbios-ssn',       // Second leaf of first tree
              value: 6
            }, {
              name: 'Apache Jserv',       // Second leaf of first tree
              value: 6
            }, {
              name: 'Microsoft ftpd',       // Second leaf of first tree
              value: 6
            }, {
              name: 'SQL Server',       // Second leaf of first tree
              value: 6
            }]
          }, {
            name: '支撑层',            // Second tree
            value: 6,
            children: [{
              name: '绘制楼板',       // Son of first tree
              value: 20,
            }, {
              name: '楼板编辑',       // Second leaf of first tree
              value: 6
            }, {
              name: '楼板分割',       // Second leaf of first tree
              value: 6
            }, {
              name: '楼板合并',       // Second leaf of first tree
              value: 6
            }, {
              name: '楼板升降',       // Second leaf of first tree
              value: 6
            }]
          }, {
            name: '应用层',            // Second tree
            value: 3,
            children: [{
              name: 'Vue.js',       // Son of first tree
              value: 20,
            }, {
              name: 'webpack',       // Second leaf of first tree
              value: 6
            }, {
              name: 'Zone.js',       // Second leaf of first tree
              value: 6
            }, {
              name: 'http',       // Second leaf of first tree
              value: 6
            }, {
              name: 'OpenRASP',       // Second leaf of first tree
              value: 6
            }, {
              name: 'Nginx',       // Second leaf of first tree
              value: 6
            }]
          }]
        }
      ]
    });
    // function colorMappingChange(value) {
    //   var levelOption = getLevelOption(value);
    //   chart.setOption({
    //     series: [{
    //       levels: levelOption
    //     }]
    //   });
    // }

    var formatUtil = echarts.format;

    function getLevelOption() {
      return [
        {
          itemStyle: {
            borderColor: '#777',
            borderWidth: 0,
            gapWidth: 1
          },
          upperLabel: {
            show: false
          }
        },
        {
          itemStyle: {
            borderColor: '#555555',
            borderWidth: 3,
            gapWidth: 1,
          },
          emphasis: {
            itemStyle: {
              borderColor: '#343434'
            }
          }
        },
        {
          colorSaturation: [0.35, 0.5],
          itemStyle: {
            borderWidth: 2,
            gapWidth: 1,
            borderColorSaturation: 0.3
          }
        }
      ];
    }

  </script>


</body>

</html>